# Goal: 
RCE

# Primitives / Bugs
I have seperated usable bugs(primitives) and other bugs

## Bugs:
1. Segfault when giving the menu no input (0 or -1)
2. p and q get a format string `%d` despite their size being _int16, causing them to overflow into each other at each `scanf` call.
3. After setting a key, we are allowed to use the encrypt and decrypt functions. We cannot set a key and then unset it. `We can set a key, encrypt, and then set a new key.`

## Primitives:

- `RSA_encrypt` has an overflow:
    *  the `encrypted` array has size `256` while the `sizeCopy` can hold up to `1024 bytes.`
    *  Also, the `sprintf`reads more data then the `s` buffer size, leading to an overflow for any input larger or equal to 642 (642*8=5136), which overwrites the stack canary leading to a stack smashing
    *  To use this, we will first need to figure out how the `encrypt` function works, so that we may get an arbitrary write.
- `RSA_decrypt` has a `FSB`. 

# Approach:

`RSA_encrypt`:

```C

__int64 __fastcall encrypt(unsigned int to_encrypt, unsigned int *public_key)
{
    return mod_exp(to_encrypt, *public_key, public_key[1]);
}

```

which is equivalent to: 

``` C

__int64 __fastcall encrypt(unsigned int to_encrypt, unsigned int *public_key)
{
    return mod_exp(to_encrypt, e, product);
}

```

Leak canary, and write a rop chain with `system` which we have the `.plt` for. No need for a leak.

